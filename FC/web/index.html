<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FCæ¸¸æˆçºªå¿µé¦† - é‡æ¸©é»„é‡‘æ—¶ä»£</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --fc-red: #e60012;
            --fc-dark-red: #b3000e;
            --fc-white: #ffffff;
            --fc-gray: #8b8b8b;
            --fc-dark: #2d2d2d;
            --fc-gold: #d4af37;
            --pixel-size: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
        }

        body {
            font-family: 'Press Start 2P', 'Microsoft YaHei', monospace;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            color: var(--fc-dark);
            min-height: 100vh;
            line-height: 1.8;
        }

        /* åƒç´ è¾¹æ¡†æ•ˆæœ */
        .pixel-border {
            position: relative;
            background: var(--fc-white);
            box-shadow:
                calc(-1 * var(--pixel-size)) 0 0 0 var(--fc-dark),
                var(--pixel-size) 0 0 0 var(--fc-dark),
                0 calc(-1 * var(--pixel-size)) 0 0 var(--fc-dark),
                0 var(--pixel-size) 0 0 var(--fc-dark);
        }

        /* å¤´éƒ¨æ ·å¼ - çº¢ç™½æœºé£æ ¼ */
        header {
            background: var(--fc-red);
            color: var(--fc-white);
            padding: 20px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 0 0 var(--fc-dark-red), 0 8px 20px rgba(0,0,0,0.3);
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 8px,
                rgba(255,255,255,0.1) 8px,
                rgba(255,255,255,0.1) 16px
            );
        }

        .logo {
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 4px 4px 0 var(--fc-dark-red);
            letter-spacing: 4px;
        }

        .tagline {
            font-size: 12px;
            opacity: 0.9;
            color: var(--fc-white);
        }

        /* å¯¼èˆªæ  */
        nav {
            background: var(--fc-dark);
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        nav a {
            color: var(--fc-white);
            text-decoration: none;
            font-size: 12px;
            padding: 10px 20px;
            background: var(--fc-gray);
            border: 4px solid var(--fc-dark);
            box-shadow: inset -4px -4px 0 0 rgba(0,0,0,0.3), 4px 4px 0 0 rgba(0,0,0,0.3);
            transition: all 0.1s;
            cursor: pointer;
        }

        nav a:hover, nav a.active {
            background: var(--fc-red);
            transform: translate(2px, 2px);
            box-shadow: inset -2px -2px 0 0 rgba(0,0,0,0.3), 2px 2px 0 0 rgba(0,0,0,0.3);
        }

        /* ä¸»å†…å®¹åŒº */
        main {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 8px 8px 0 0 rgba(0,0,0,0.2);
        }

        .card-title {
            color: var(--fc-red);
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 4px dashed var(--fc-gray);
        }

        /* ç»Ÿè®¡é¢æ¿ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: var(--fc-red);
            color: var(--fc-white);
            padding: 25px;
            text-align: center;
            border: 4px solid var(--fc-dark);
            box-shadow: 6px 6px 0 0 rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 32px;
            margin-bottom: 10px;
            text-shadow: 4px 4px 0 var(--fc-dark-red);
        }

        .stat-label {
            font-size: 10px;
            opacity: 0.9;
        }

        /* æ¸¸æˆå¡å¸¦æ ·å¼ */
        .game-cartridge {
            background: linear-gradient(145deg, #ddd 0%, #bbb 100%);
            border: 4px solid var(--fc-dark);
            padding: 15px;
            display: flex;
            gap: 20px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 6px 6px 0 0 rgba(0,0,0,0.2);
        }

        .game-cartridge:hover {
            transform: translate(-4px, -4px);
            box-shadow: 10px 10px 0 0 rgba(0,0,0,0.2);
        }

        .game-cover {
            width: 128px;
            height: 180px;
            background: var(--fc-red);
            border: 4px solid var(--fc-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--fc-white);
            font-size: 10px;
            text-align: center;
            flex-shrink: 0;
        }

        .game-info {
            flex: 1;
        }

        .game-title {
            color: var(--fc-red);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .game-meta {
            font-size: 10px;
            color: var(--fc-gray);
            margin-bottom: 10px;
        }

        .game-rating {
            color: var(--fc-gold);
            font-size: 12px;
        }

        .game-desc {
            font-size: 10px;
            line-height: 1.6;
            color: var(--fc-dark);
            margin-top: 10px;
        }

        /* æœç´¢æ  */
        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .search-input, .filter-select {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            font-family: inherit;
            font-size: 12px;
            border: 4px solid var(--fc-dark);
            background: var(--fc-white);
            box-shadow: inset 4px 4px 0 0 rgba(0,0,0,0.1);
        }

        .search-btn {
            padding: 15px 30px;
            background: var(--fc-red);
            color: var(--fc-white);
            border: 4px solid var(--fc-dark);
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
            box-shadow: 4px 4px 0 0 rgba(0,0,0,0.2);
            transition: all 0.1s;
        }

        .search-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 0 rgba(0,0,0,0.2);
        }

        .search-btn:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }

        /* æ—¶é—´è½´ */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 8px;
            background: var(--fc-red);
            border: 2px solid var(--fc-dark);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -35px;
            top: 5px;
            width: 20px;
            height: 20px;
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            box-shadow: 2px 2px 0 0 rgba(0,0,0,0.2);
        }

        .timeline-year {
            color: var(--fc-red);
            font-size: 18px;
            margin-bottom: 10px;
        }

        .timeline-content {
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            padding: 20px;
            box-shadow: 6px 6px 0 0 rgba(0,0,0,0.1);
        }

        /* æ¸¸æˆç½‘æ ¼ */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            overflow: hidden;
            cursor: pointer;
            box-shadow: 6px 6px 0 0 rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .game-card:hover {
            transform: translate(-4px, -4px);
            box-shadow: 10px 10px 0 0 rgba(0,0,0,0.2);
        }

        .game-card-cover {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, var(--fc-red) 0%, var(--fc-dark-red) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--fc-white);
            font-size: 12px;
            text-align: center;
            padding: 20px;
        }

        .game-card-info {
            padding: 15px;
        }

        .game-card-title {
            font-size: 12px;
            color: var(--fc-red);
            margin-bottom: 8px;
        }

        .game-card-meta {
            font-size: 10px;
            color: var(--fc-gray);
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            text-align: center;
            padding: 60px;
        }

        .loading-text {
            color: var(--fc-red);
            font-size: 14px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* é”™è¯¯æç¤º */
        .error-box {
            background: #ffe5e5;
            border: 4px solid var(--fc-red);
            padding: 30px;
            text-align: center;
            color: var(--fc-red);
        }

        /* æ¸¸æˆè¯¦æƒ…å¼¹çª— */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }

        .modal-content {
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 20px 20px 0 0 rgba(0,0,0,0.3);
        }

        .modal-header {
            background: var(--fc-red);
            color: var(--fc-white);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 14px;
            text-shadow: 2px 2px 0 var(--fc-dark-red);
        }

        .modal-close {
            background: var(--fc-white);
            border: 4px solid var(--fc-dark);
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-gallery {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .modal-image {
            background: var(--fc-gray);
            border: 4px solid var(--fc-dark);
            aspect-ratio: 4/3;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--fc-white);
            font-size: 10px;
        }

        .modal-info {
            font-size: 11px;
            line-height: 2;
        }

        .modal-info dt {
            color: var(--fc-red);
            font-weight: bold;
        }

        .modal-info dd {
            margin-bottom: 15px;
            margin-left: 0;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            background: var(--fc-gray);
            color: var(--fc-white);
            border: 4px solid var(--fc-dark);
            font-family: inherit;
            font-size: 10px;
            cursor: pointer;
            box-shadow: 4px 4px 0 0 rgba(0,0,0,0.2);
            transition: all 0.1s;
        }

        .action-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 0 rgba(0,0,0,0.2);
        }

        .action-btn.primary {
            background: var(--fc-red);
        }

        /* é¡µè„š */
        footer {
            background: var(--fc-dark);
            color: var(--fc-white);
            padding: 40px 20px;
            text-align: center;
            margin-top: 60px;
        }

        .footer-logo {
            font-size: 16px;
            color: var(--fc-red);
            margin-bottom: 15px;
        }

        .footer-text {
            font-size: 10px;
            opacity: 0.7;
            line-height: 2;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .logo {
                font-size: 16px;
            }

            nav a {
                font-size: 10px;
                padding: 8px 12px;
            }

            .game-cartridge {
                flex-direction: column;
            }

            .game-cover {
                width: 100%;
                height: 150px;
            }

            .modal-gallery {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-number {
                font-size: 20px;
            }
        }

        /* 8-bitè£…é¥°å…ƒç´  */
        .pixel-decoration {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--fc-red);
            margin: 0 4px;
        }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨ -->
    <header>
        <h1 class="logo">ğŸ® FCæ¸¸æˆçºªå¿µé¦† ğŸ®</h1>
        <p class="tagline">é‡æ¸©é»„é‡‘æ—¶ä»£ï¼Œè®°å½•æ¸¸æˆè®°å¿† (1983-2003)</p>
    </header>

    <!-- å¯¼èˆª -->
    <nav>
        <a href="#home" class="active" data-section="home">ğŸ  é¦–é¡µ</a>
        <a href="#games" data-section="games">ğŸ® æ¸¸æˆç™¾ç§‘</a>
        <a href="#timeline" data-section="timeline">ğŸ“… å†å²å›é¡¾</a>
        <a href="#about" data-section="about">â„¹ï¸ å…³äº</a>
    </nav>

    <!-- ä¸»å†…å®¹ -->
    <main>
        <!-- é¦–é¡µ -->
        <section id="home" class="section active">
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-number" id="stat-total-games">--</div>
                    <div class="stat-label">æ”¶å½•æ¸¸æˆ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-total-years">--</div>
                    <div class="stat-label">å†å²å¹´ä»½</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-developers">--</div>
                    <div class="stat-label">å¼€å‘å•†</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="stat-genre">--</div>
                    <div class="stat-label">çƒ­é—¨ç±»å‹</div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">ğŸŒŸ ç»å…¸æ¨è</h2>
                <div id="featured-games">
                    <div class="loading">
                        <p class="loading-text">æ­£åœ¨åŠ è½½...</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">ğŸ“¢ æœ€æ–°åŠ¨æ€</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-year">2024</div>
                        <div class="timeline-content">
                            <strong>FCæ¸¸æˆçºªå¿µé¦†æ­£å¼ä¸Šçº¿ï¼</strong><br><br>
                            <span style="font-size: 10px; color: var(--fc-gray);">
                                æˆ‘ä»¬è‡´åŠ›äºä¸ºå…¨çƒFCæ¸¸æˆçˆ±å¥½è€…æä¾›æœ€å…¨é¢çš„æ¸¸æˆå†å²æ¡£æ¡ˆã€‚
                                ç½‘ç«™æ”¶å½•1983-2003å¹´é—´FCå¹³å°ç»å…¸æ¸¸æˆï¼ŒåŒ…å«è¯¦ç»†çš„æ¸¸æˆä»‹ç»ã€
                                å†å²èƒŒæ™¯ã€æˆªå›¾å±•ç¤ºç­‰åŠŸèƒ½ã€‚æ¬¢è¿æ¢ç´¢è¿™æ®µé»„é‡‘æ¸¸æˆå†å²ï¼
                            </span>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-year">2003</div>
                        <div class="timeline-content">
                            <strong>FCçº¢ç™½æœºæ­£å¼åœäº§</strong><br><br>
                            <span style="font-size: 10px; color: var(--fc-gray);">
                                ä»»å¤©å ‚å®£å¸ƒFCæ­£å¼åœäº§ï¼Œç»“æŸäº†é•¿è¾¾20å¹´çš„è¾‰ç…Œå†å²ã€‚
                                FCå…¨çƒé”€é‡è¶…è¿‡6100ä¸‡å°ï¼Œæ¸¸æˆé”€é‡è¶…è¿‡5äº¿ä»½ã€‚
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ¸¸æˆç™¾ç§‘ -->
        <section id="games" class="section">
            <div class="card">
                <h2 class="card-title">ğŸ” æœç´¢æ¸¸æˆ</h2>
                <div class="search-bar">
                    <input type="text" class="search-input" id="search-input" placeholder="è¾“å…¥æ¸¸æˆåç§°æœç´¢...">
                    <select class="filter-select" id="year-filter">
                        <option value="">æ‰€æœ‰å¹´ä»½</option>
                    </select>
                    <select class="filter-select" id="genre-filter">
                        <option value="">æ‰€æœ‰ç±»å‹</option>
                    </select>
                    <button class="search-btn" onclick="searchGames()">ğŸ” æœç´¢</button>
                </div>
            </div>

            <div id="games-list">
                <div class="loading">
                    <p class="loading-text">æ­£åœ¨åŠ è½½æ¸¸æˆåˆ—è¡¨...</p>
                </div>
            </div>
        </section>

        <!-- å†å²å›é¡¾ -->
        <section id="timeline" class="section">
            <div class="card">
                <h2 class="card-title">ğŸ“… FCå‘å±•æ—¶é—´è½´ (1983-2003)</h2>
                <div class="timeline" id="history-timeline">
                    <div class="loading">
                        <p class="loading-text">æ­£åœ¨åŠ è½½å†å²æ•°æ®...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- å…³äº -->
        <section id="about" class="section">
            <div class="card">
                <h2 class="card-title">â„¹ï¸ å…³äºFCæ¸¸æˆçºªå¿µé¦†</h2>
                <div style="font-size: 11px; line-height: 2;">
                    <p style="margin-bottom: 20px;">
                        <strong>FCæ¸¸æˆçºªå¿µé¦†</strong>æ˜¯ä¸€æ¬¾ä¸“æ³¨äºFCï¼ˆFamily Computerï¼‰æ¸¸æˆå†å²çš„åœ¨çº¿å¹³å°ï¼Œ
                        è®°å½•1983-2003å¹´é—´20å¹´çš„FCæ¸¸æˆå‘å±•å†ç¨‹ã€‚
                    </p>
                    <p style="margin-bottom: 20px;">
                        å¹³å°é›†æ¸¸æˆç™¾ç§‘ã€å†å²å›é¡¾ã€ä¸ªäººæ”¶è—ç®¡ç†ã€ç¤¾åŒºäº’åŠ¨äºä¸€ä½“ï¼Œ
                        ä¸ºå…¨çƒFCæ¸¸æˆçˆ±å¥½è€…æä¾›æƒå¨ã€å…¨é¢ã€äº’åŠ¨çš„æ¸¸æˆå†å²æ¡£æ¡ˆã€‚
                    </p>
                    <h3 style="color: var(--fc-red); margin: 30px 0 15px;">ğŸ¯ äº§å“æ„¿æ™¯</h3>
                    <p style="margin-bottom: 20px;">
                        æˆä¸ºFCæ¸¸æˆå†å²é¢†åŸŸæœ€æƒå¨ã€æœ€å…¨é¢çš„æ•°å­—æ¡£æ¡ˆé¦†ï¼Œ
                        è¿æ¥å…¨çƒæ€€æ—§ç©å®¶çš„æƒ…æ„Ÿçº½å¸¦ã€‚
                    </p>
                    <h3 style="color: var(--fc-red); margin: 30px 0 15px;">ğŸ’¬ äº§å“å£å·</h3>
                    <p style="font-size: 14px; color: var(--fc-red); text-align: center; padding: 20px; border: 4px dashed var(--fc-red);">
                        "é‡æ¸©é»„é‡‘æ—¶ä»£ï¼Œè®°å½•æ¸¸æˆè®°å¿†"
                    </p>
                    <h3 style="color: var(--fc-red); margin: 30px 0 15px;">ğŸ“Š æ•°æ®è¯´æ˜</h3>
                    <p>
                        â€¢ æ”¶å½•æ—¶é—´èŒƒå›´ï¼š1983å¹´ - 2003å¹´<br>
                        â€¢ æ¸¸æˆæ€»æ•°ï¼šè¶…è¿‡1000æ¬¾<br>
                        â€¢ æ•°æ®æ›´æ–°ï¼šæŒç»­æ›´æ–°ä¸­<br>
                        â€¢ å›¾ç‰‡æ¥æºï¼šç½‘ç»œæ”¶é›†æ•´ç†
                    </p>
                </div>
            </div>
        </section>
    </main>

    <!-- æ¸¸æˆè¯¦æƒ…å¼¹çª— -->
    <div class="modal-overlay" id="game-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">æ¸¸æˆè¯¦æƒ…</h3>
                <button class="modal-close" onclick="closeModal()">âœ•</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- åŠ¨æ€å†…å®¹ -->
            </div>
        </div>
    </div>

    <!-- é¡µè„š -->
    <footer>
        <div class="footer-logo">ğŸ® FCæ¸¸æˆçºªå¿µé¦† ğŸ®</div>
        <div class="footer-text">
            <p>é‡æ¸©é»„é‡‘æ—¶ä»£ï¼Œè®°å½•æ¸¸æˆè®°å¿†</p>
            <p style="margin-top: 15px;">
                Â© 2024 FC Game Memorial Hall | è‡´æ•¬ç»å…¸ï¼Œè‡´æ•¬ç«¥å¹´
            </p>
        </div>
    </footer>

    <script>
        // API åŸºç¡€URL
        const API_BASE = 'http://localhost:3001/api';

        // é¡µé¢çŠ¶æ€
        let currentSection = 'home';
        let allGames = [];

        // å¯¼èˆªåˆ‡æ¢
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.dataset.section;
                switchSection(section);

                // æ›´æ–°å¯¼èˆªçŠ¶æ€
                document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
                link.classList.add('active');
            });
        });

        function switchSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            currentSection = section;

            // æ ¹æ®é¡µé¢åŠ è½½æ•°æ®
            if (section === 'home') {
                loadHomeData();
            } else if (section === 'games') {
                loadGames();
            } else if (section === 'timeline') {
                loadTimeline();
            }
        }

        // è·å–æ•°æ®
        async function fetchData(endpoint) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`);
                if (!response.ok) throw new Error('Network error');
                return await response.json();
            } catch (error) {
                console.error('Fetch error:', error);
                return null;
            }
        }

        // åŠ è½½é¦–é¡µæ•°æ®
        async function loadHomeData() {
            // åŠ è½½ç»Ÿè®¡ä¿¡æ¯
            const stats = await fetchData('/stats');
            if (stats) {
                document.getElementById('stat-total-games').textContent = stats.totalGames || '--';
                document.getElementById('stat-total-years').textContent = stats.totalYears || '--';
                document.getElementById('stat-developers').textContent = stats.totalDevelopers || '--';
                document.getElementById('stat-genre').textContent = stats.mostPopularGenre || '--';
            }

            // åŠ è½½æ¨èæ¸¸æˆ
            const games = await fetchData('/games?sort=rating&order=desc');
            if (games && games.games) {
                const featuredContainer = document.getElementById('featured-games');
                const featured = games.games.slice(0, 3);

                featuredContainer.innerHTML = featured.map(game => `
                    <div class="game-cartridge" onclick="showGameDetail(${game.id})">
                        <div class="game-cover" style="background: linear-gradient(135deg, var(--fc-red) 0%, var(--fc-dark-red) 100%);">
                            <span>${game.name}</span>
                        </div>
                        <div class="game-info">
                            <div class="game-title">${game.name}</div>
                            <div class="game-meta">
                                ${game.year}å¹´ | ${game.developer} | ${game.genre}
                            </div>
                            <div class="game-rating">â˜… ${game.rating}</div>
                            <div class="game-desc">${game.description.substring(0, 80)}...</div>
                        </div>
                    </div>
                `).join('<br>');
            } else {
                document.getElementById('featured-games').innerHTML = `
                    <div class="error-box">
                        <p>æ— æ³•åŠ è½½æ¸¸æˆæ•°æ®</p>
                        <p style="font-size: 10px; margin-top: 15px;">è¯·ç¡®ä¿æœåŠ¡å™¨å·²å¯åŠ¨: npm start</p>
                    </div>
                `;
            }
        }

        // åŠ è½½æ¸¸æˆåˆ—è¡¨
        async function loadGames() {
            // åŠ è½½ç­›é€‰é€‰é¡¹
            const [years, genres, games] = await Promise.all([
                fetchData('/years'),
                fetchData('/genres'),
                fetchData('/games')
            ]);

            // å¡«å……å¹´ä»½ç­›é€‰
            if (years) {
                const yearSelect = document.getElementById('year-filter');
                yearSelect.innerHTML = '<option value="">æ‰€æœ‰å¹´ä»½</option>' +
                    years.map(y => `<option value="${y}">${y}å¹´</option>`).join('');
            }

            // å¡«å……ç±»å‹ç­›é€‰
            if (genres) {
                const genreSelect = document.getElementById('genre-filter');
                genreSelect.innerHTML = '<option value="">æ‰€æœ‰ç±»å‹</option>' +
                    genres.map(g => `<option value="${g}">${g}</option>`).join('');
            }

            // æ˜¾ç¤ºæ¸¸æˆåˆ—è¡¨
            if (games && games.games) {
                allGames = games.games;
                renderGamesList(allGames);
            } else {
                document.getElementById('games-list').innerHTML = `
                    <div class="error-box">
                        <p>æ— æ³•åŠ è½½æ¸¸æˆåˆ—è¡¨</p>
                        <p style="font-size: 10px; margin-top: 15px;">è¯·ç¡®ä¿æœåŠ¡å™¨å·²å¯åŠ¨</p>
                    </div>
                `;
            }
        }

        function renderGamesList(games) {
            const container = document.getElementById('games-list');
            if (games.length === 0) {
                container.innerHTML = '<div class="card"><p style="text-align: center; color: var(--fc-gray);">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ¸¸æˆ</p></div>';
                return;
            }

            container.innerHTML = `
                <div class="games-grid">
                    ${games.map(game => `
                        <div class="game-card" onclick="showGameDetail(${game.id})">
                            <div class="game-card-cover" style="background: linear-gradient(135deg, ${getRandomColor()} 0%, ${getRandomColor(true)} 100%);">
                                <span>${game.name}</span>
                            </div>
                            <div class="game-card-info">
                                <div class="game-card-title">${game.name}</div>
                                <div class="game-card-meta">
                                    ${game.year}å¹´ | ${game.developer}<br>
                                    ${game.genre} | â˜… ${game.rating}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getRandomColor(dark = false) {
            const colors = dark ? ['#b3000e', '#990000', '#660000'] : ['#e60012', '#0066cc', '#009944', '#663399', '#ff8800'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // æœç´¢æ¸¸æˆ
        async function searchGames() {
            const search = document.getElementById('search-input').value;
            const year = document.getElementById('year-filter').value;
            const genre = document.getElementById('genre-filter').value;

            let query = '/games?';
            if (search) query += `search=${encodeURIComponent(search)}&`;
            if (year) query += `year=${year}&`;
            if (genre) query += `genre=${encodeURIComponent(genre)}&`;

            const games = await fetchData(query);
            if (games) {
                renderGamesList(games.games);
            }
        }

        // åŠ è½½æ—¶é—´è½´
        async function loadTimeline() {
            const timeline = await fetchData('/timeline');
            const events = await fetchData('/events');

            if (!timeline || !events) {
                document.getElementById('history-timeline').innerHTML = `
                    <div class="error-box">
                        <p>æ— æ³•åŠ è½½å†å²æ•°æ®</p>
                    </div>
                `;
                return;
            }

            const container = document.getElementById('history-timeline');
            let html = '';

            for (let year = 1983; year <= 2003; year++) {
                const yearData = timeline[year];
                const yearEvents = events.filter(e => e.year === year);

                if (yearData.gameCount > 0 || yearEvents.length > 0) {
                    html += `
                        <div class="timeline-item">
                            <div class="timeline-year">${year}å¹´</div>
                            <div class="timeline-content">
                                ${yearEvents.map(e => `
                                    <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 2px dashed #eee;">
                                        <strong style="color: var(--fc-red);">${e.title}</strong><br>
                                        <span style="font-size: 10px; color: var(--fc-gray);">${e.description}</span>
                                    </div>
                                `).join('')}
                                ${yearData.gameCount > 0 ? `
                                    <div style="font-size: 10px; color: var(--fc-gray);">
                                        ğŸ“Š è¯¥å¹´å‘å”®æ¸¸æˆ: ${yearData.gameCount} æ¬¾<br>
                                        ğŸ® ä»£è¡¨ä½œå“: ${yearData.games.slice(0, 3).map(g => g.name).join('ã€')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }
            }

            container.innerHTML = html || '<p style="text-align: center;">æš‚æ— å†å²æ•°æ®</p>';
        }

        // æ˜¾ç¤ºæ¸¸æˆè¯¦æƒ…
        async function showGameDetail(gameId) {
            const game = await fetchData(`/games/${gameId}`);
            if (!game) return;

            document.getElementById('modal-title').textContent = game.name;
            document.getElementById('modal-body').innerHTML = `
                <div class="modal-gallery">
                    <div class="modal-image" style="grid-column: span 2; background: linear-gradient(135deg, var(--fc-red) 0%, var(--fc-dark-red) 100%);">
                        <span>ğŸ® ${game.name}</span>
                    </div>
                    <div class="modal-image">æ¸¸æˆæˆªå›¾ 1</div>
                    <div class="modal-image">æ¸¸æˆæˆªå›¾ 2</div>
                </div>

                <dl class="modal-info">
                    <dt>æ¸¸æˆåç§°</dt>
                    <dd>${game.name} / ${game.nameEn} / ${game.nameJp}</dd>

                    <dt>åŸºæœ¬ä¿¡æ¯</dt>
                    <dd>
                        å‘è¡Œå¹´ä»½: ${game.year}å¹´<br>
                        å¼€å‘å•†: ${game.developer}<br>
                        å‘è¡Œå•†: ${game.publisher}<br>
                        æ¸¸æˆç±»å‹: ${game.genre}<br>
                        ç©å®¶äººæ•°: ${game.players}äºº
                    </dd>

                    <dt>æ¸¸æˆæ•°æ®</dt>
                    <dd>
                        å…³å¡æ•°é‡: ${game.levels}<br>
                        æ¸¸æˆæ—¶é•¿: ${game.playTime}<br>
                        éš¾åº¦ç­‰çº§: ${game.difficulty}
                    </dd>

                    <dt>æ¸¸æˆä»‹ç»</dt>
                    <dd style="line-height: 1.8;">${game.description}</dd>

                    <dt>è¯„åˆ†</dt>
                    <dd style="color: var(--fc-gold); font-size: 18px;">â˜… ${game.rating} / 10</dd>
                </dl>

                <div class="action-buttons">
                    <button class="action-btn primary" onclick="alert('å·²æ ‡è®°ä¸º"æˆ‘ç©è¿‡"')">âœ“ æˆ‘ç©è¿‡</button>
                    <button class="action-btn" onclick="alert('å·²æ·»åŠ åˆ°æƒ³ç©æ¸…å•')">+ æƒ³ç©</button>
                    <button class="action-btn" onclick="alert('å·²æ·»åŠ åˆ°æ”¶è—')">â˜… æ”¶è—</button>
                </div>

                ${game.similarGames && game.similarGames.length > 0 ? `
                    <h3 style="color: var(--fc-red); margin: 30px 0 15px; font-size: 12px;">ğŸ® ç›¸ä¼¼æ¸¸æˆæ¨è</h3>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        ${game.similarGames.map(g => `
                            <div style="flex: 1; min-width: 150px; padding: 15px; background: #f5f5f5; border: 2px solid var(--fc-dark); cursor: pointer;"
                                 onclick="showGameDetail(${g.id})">
                                <div style="font-size: 10px; color: var(--fc-red);">${g.name}</div>
                                <div style="font-size: 9px; color: var(--fc-gray);">${g.year}å¹´ | â˜… ${g.rating}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;

            document.getElementById('game-modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('game-modal').classList.remove('active');
        }

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        document.getElementById('game-modal').addEventListener('click', (e) => {
            if (e.target.id === 'game-modal') {
                closeModal();
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadHomeData();
        });
    </script>
</body>
</html>
